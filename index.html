<!DOCTYPE html>
<html>

<head>
  <title>Simple React App</title>
</head>

<body>

  <div id="root"></div>

  <script src="https://cdn.jsdelivr.net/npm/react@18.2.0/umd/react.production.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/react-dom@18.2.0/umd/react-dom.production.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/babel-standalone@6.26.0/babel.min.js"></script>
  <script>window.react = React;</script>
  <script src="dist/statsig-react.min.js"></script>
  <script src="dist/statsig-js-local-eval.min.js"></script>
  <script src="dist/statsig-js-remote-eval.min.js"></script>

  <script type="text/babel">
    const { useState, useEffect, useMemo } = React;
    const { StatsigProvider, StatsigRemoteEvalClient, StatsigLocalEvalClient, useGate, useClientLoadingStatus } = __STATSIG__;

    const remoteEvalClient = new StatsigRemoteEvalClient(
      'client-wlH3WMkysINMhMU8VrNBkbjrEr2JQrqgxKwDPOUosJK',
    );

    const localEvalClient = new StatsigLocalEvalClient(
      'client-wlH3WMkysINMhMU8VrNBkbjrEr2JQrqgxKwDPOUosJK',
    )

    function Content() {
      const { value } = useGate("test_public");
      const { value: localEvalValue } = useGate("test_public", { localEvalUser: { userID: 'loca-eval-user' } });
      return <div>
        <div>test_public (Remote): {value ? "Pass" : "Fail"}</div>
        <div>test_public (Local): {localEvalValue ? "Pass" : "Fail"}</div>
      </div>;
    }

    function App() {
      const [count, setCount] = useState(0);

      const [version, setVersion] = useState(0)

      useEffect(() => {
        remoteEvalClient.initialize({ userID: 'remote-eval-user' }).then(() => {
          setVersion(version + 1)
        });
        localEvalClient.initialize().then(() => {
          setVersion(version + 1)
        });
      }, [remoteEvalClient])


      return (
        <div>
          <div>Remote: {remoteEvalClient.loadingStatus}</div>
          <div>Local: {localEvalClient.loadingStatus}</div>
          <br />
          <StatsigProvider remoteEvalClient={remoteEvalClient} localEvalClient={localEvalClient}>
            <Content />
          </StatsigProvider>

        </div>
      );
    }

    ReactDOM.render(<App />, document.getElementById('root'));
  </script>

</body>

</html>